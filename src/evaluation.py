# -*- coding: utf-8 -*-
"""Evaluation.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1YqInRMH4Sc3u86NUJ6t1dXmP9vGSqy3a
"""

from PIL import Image
import matplotlib.pyplot as plt
from skimage.filters import threshold_otsu  # ← 自動しきい値化に使う
import numpy as np
# 画像ファイルのパスを指定してください
img1 = np.array(Image.open('testB1.png').convert('L'))
plt.imshow(img1)
plt.show()

img2 = np.array(Image.open('testB2.png').convert('L'))
plt.imshow(img2)
plt.show()

th1 = threshold_otsu(img1)
th2 = threshold_otsu(img2)
bw1 = (img1 > th1).astype(float)
bw2 = (img2 > th2).astype(float)

plt.subplot(1,2,1); plt.imshow(bw1, cmap='gray')
plt.title("Image 1 (binary)"); plt.axis('off')
plt.subplot(1,2,2); plt.imshow(bw2, cmap='gray')
plt.title("Image 2 (binary)"); plt.axis('off')
plt.show()

bw3=1-bw2

plt.subplot(1,2,1); plt.imshow(bw1, cmap='gray')
plt.title("Image 1 (binary)"); plt.axis('off')
plt.subplot(1,2,2); plt.imshow(bw3, cmap='gray')
plt.title("Image 3 (binary)"); plt.axis('off')
plt.show()



MAE = np.mean(np.abs(bw1 - bw3))
print(f"MAE = {MAE:.4f}")

IoU = np.logical_and(bw1, bw3).sum() / np.logical_or(bw1, bw3).sum()
print(f"IoU = {IoU:.4f}")

